"""
SAM2 íŒŒì¸íŠœë‹ì„ ìœ„í•œ ë°ì´í„° ì¤€ë¹„ ìŠ¤í¬ë¦½íŠ¸
ì´ˆë³´ììš© - ë‹¨ê³„ë³„ ì„¤ëª… í¬í•¨
"""

import os
import json
from pathlib import Path

def create_data_structure():
    """
    SAM2 íŒŒì¸íŠœë‹ì— í•„ìš”í•œ í´ë” êµ¬ì¡°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

    í•„ìš”í•œ êµ¬ì¡°:
    data/
    â”œâ”€â”€ images/          # ì›ë³¸ ì´ë¯¸ì§€ë“¤
    â”‚   â”œâ”€â”€ train/       # í•™ìŠµìš© ì´ë¯¸ì§€
    â”‚   â””â”€â”€ val/         # ê²€ì¦ìš© ì´ë¯¸ì§€
    â”œâ”€â”€ masks/           # ì •ë‹µ ë§ˆìŠ¤í¬ë“¤ (ì–´ë…¸í…Œì´ì…˜)
    â”‚   â”œâ”€â”€ train/       # í•™ìŠµìš© ë§ˆìŠ¤í¬
    â”‚   â””â”€â”€ val/         # ê²€ì¦ìš© ë§ˆìŠ¤í¬
    â””â”€â”€ annotations.json # ë©”íƒ€ë°ì´í„° (ì„ íƒì‚¬í•­)
    """

    base_path = Path("data")

    # í´ë” ìƒì„±
    folders = [
        "images/train",
        "images/val",
        "masks/train",
        "masks/val",
    ]

    for folder in folders:
        path = base_path / folder
        path.mkdir(parents=True, exist_ok=True)
        print(f"âœ… í´ë” ìƒì„±: {path}")

    # ìƒ˜í”Œ annotations.json ìƒì„±
    sample_annotations = {
        "info": {
            "description": "SAM2 Fine-tuning Dataset",
            "version": "1.0",
            "date_created": "2025-01-28"
        },
        "images": [
            # ì˜ˆì‹œ - ì‹¤ì œ ì´ë¯¸ì§€ ì¶”ê°€ ì‹œ ìˆ˜ì • í•„ìš”
            # {
            #     "id": 1,
            #     "file_name": "image_001.jpg",
            #     "width": 640,
            #     "height": 480
            # }
        ],
        "annotations": [
            # ì˜ˆì‹œ - ì‹¤ì œ ë§ˆìŠ¤í¬ ì¶”ê°€ ì‹œ ìˆ˜ì • í•„ìš”
            # {
            #     "id": 1,
            #     "image_id": 1,
            #     "mask_file": "mask_001.png",
            #     "category": "object"
            # }
        ]
    }

    with open(base_path / "annotations.json", "w", encoding="utf-8") as f:
        json.dump(sample_annotations, f, indent=2, ensure_ascii=False)
    print(f"âœ… ì–´ë…¸í…Œì´ì…˜ í…œí”Œë¦¿ ìƒì„±: {base_path / 'annotations.json'}")

    return base_path


def print_data_guide():
    """ë°ì´í„° ì¤€ë¹„ ê°€ì´ë“œë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤."""

    guide = """
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              ğŸ“š ë°ì´í„° ì¤€ë¹„ ê°€ì´ë“œ (ì´ˆë³´ììš©)                    â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                â•‘
â•‘  1ï¸âƒ£  ì´ë¯¸ì§€ ì¤€ë¹„                                                â•‘
â•‘      â€¢ ì„¸ë¶„í™”í•˜ê³  ì‹¶ì€ ëŒ€ìƒì´ í¬í•¨ëœ ì´ë¯¸ì§€ë“¤                      â•‘
â•‘      â€¢ í˜•ì‹: JPG, PNG (ê¶Œì¥ í¬ê¸°: 640x480 ~ 1920x1080)           â•‘
â•‘      â€¢ ìµœì†Œ 10~20ì¥ ê¶Œì¥ (ë§ì„ìˆ˜ë¡ ì¢‹ìŒ)                          â•‘
â•‘                                                                â•‘
â•‘  2ï¸âƒ£  ë§ˆìŠ¤í¬(ì–´ë…¸í…Œì´ì…˜) ì¤€ë¹„                                     â•‘
â•‘      â€¢ ì´ë¯¸ì§€ì™€ 1:1 ëŒ€ì‘ë˜ëŠ” ë§ˆìŠ¤í¬ ì´ë¯¸ì§€                        â•‘
â•‘      â€¢ í˜•ì‹: PNG (í‘ë°± - í°ìƒ‰=ëŒ€ìƒ, ê²€ì •=ë°°ê²½)                    â•‘
â•‘      â€¢ íŒŒì¼ëª…: ì›ë³¸ê³¼ ë™ì¼í•˜ê²Œ ë§ì¶”ê¸°                            â•‘
â•‘        ì˜ˆ) image_001.jpg â†’ image_001.png (ë§ˆìŠ¤í¬)               â•‘
â•‘                                                                â•‘
â•‘  3ï¸âƒ£  ì–´ë…¸í…Œì´ì…˜ ë„êµ¬ ì¶”ì²œ                                       â•‘
â•‘      â€¢ LabelMe (ë¬´ë£Œ, ê°„ë‹¨) - https://labelme.csail.mit.edu     â•‘
â•‘      â€¢ CVAT (ë¬´ë£Œ, ì›¹ê¸°ë°˜) - https://cvat.ai                    â•‘
â•‘      â€¢ Roboflow (ë¬´ë£Œ í‹°ì–´ ìˆìŒ) - https://roboflow.com         â•‘
â•‘                                                                â•‘
â•‘  4ï¸âƒ£  ë°ì´í„° ë¶„í•                                                 â•‘
â•‘      â€¢ train: 80% (í•™ìŠµìš©)                                      â•‘
â•‘      â€¢ val: 20% (ê²€ì¦ìš©)                                        â•‘
â•‘                                                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
"""
    print(guide)


if __name__ == "__main__":
    print("\nğŸš€ SAM2 ë°ì´í„° êµ¬ì¡° ìƒì„± ì¤‘...\n")
    create_data_structure()
    print_data_guide()
    print("\nâœ¨ ì™„ë£Œ! ì´ì œ data/images/train í´ë”ì— ì´ë¯¸ì§€ë¥¼ ë„£ì–´ì£¼ì„¸ìš”.")
